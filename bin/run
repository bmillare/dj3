#!/usr/bin/env bash
if [ ! -d "$HOME/.dj" ]; then
git --version 2>&1 > /dev/null
GIT_IS_AVAILABLE=$?
if [ $GIT_IS_AVAILABLE -eq 0 ]; then
echo "Installing dj3 with git"
pushd ~/
git clone https://github.com/bmillare/dj3.git ~/.dj
popd
else
echo "Installing dj3 from zip"
mkdir -p ~/.dj.tmp
pushd ~/.dj.tmp
curl -O https://github.com/bmillare/dj3/archive/master.zip
unzip master.zip
mv dj3-master ~/.dj
popd
rm -rf ~/.dj.tmp
fi
mkdir -p ~/.dj/jars
pushd ~/.dj/jars
curl -Ok 'https://utz.icm.jhu.edu/~bmillar1/dj.project-1.0.1-standalone.jar'
curl -O 'http://repo1.maven.org/maven2/org/clojure/clojure/1.9.0-alpha17/clojure-1.9.0-alpha17.jar'
curl -O 'http://repo1.maven.org/maven2/org/clojure/spec.alpha/0.1.123/spec.alpha-0.1.123.jar'
curl -O 'http://repo1.maven.org/maven2/org/clojure/core.specs.alpha/0.1.10/core.specs.alpha-0.1.10.jar'
popd
fi
java -cp $HOME/.dj/src:$HOME/.dj/usr/src:$HOME/.dj/jars/* clojure.main $@
